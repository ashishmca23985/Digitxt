<!DOCTYPE html>
<html lang="en">
<!-- Page generated at 2019-10-10 10:07:09 -->

<!-- Mirrored from www.bulksms.com/developer/eapi/code-samples/csharp/send_sms/ by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 15 Oct 2019 07:43:30 GMT -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>C# SMS Code Sample - Send SMS - API - BulkSMS.com</title>

    <link rel="stylesheet" href="../../../../css/bootstrap-3.1.1.min.css">
    <link rel="stylesheet" href="../../../../css/bootstrap-docs.min.css">
    <link rel="stylesheet" href="../../../../css/highlightjs-8.4.min.css">
    <link rel="stylesheet" href="../../../../css/styles.css">
    <link rel="stylesheet" href="../../../../css/font-awesome.min.css">

</head>
<body>
    <div class="navbar navbar-default navbar-static-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="../../../../../index.html" target="_blank"><img src="../../../../images/bulksms.png"></a>
            </div>
            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li><a style="background: grey; color: white; border: 1px solid grey" href="../../../../index.html">Developers</a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="container bulksms-content">
        <b><a class="popover-help-link" tabindex="0" role="button" data-toggle="popover" data-trigger="focus" title="Deprecated" data-content="This API is no longer actively developed - however, it is still available for the use of customers with existing integrations.">Deprecated</a> - please use the <a href="../../../../json/v1/index.html#tag/Message%2Fpaths%2F~1messages%2Fpost">JSON API</a> instead.</b>

<div class="container">
  <div class="row">
    <div class="col-md-10">
      <h1 id="send_smscs">send_sms.cs</h1>
<p><a href="send_sms.cs" class="download code-sample-download">download</a></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/* We use the HttpUtility class from the System.Web namespace
*
* If you see of the error "'HttpUtility' is not declared", you are probably
* using a newer version of Visual Studio. You need to navigate to
* Project | &lt;Project name&gt; Properties | Application,
* and select e.g. ".NET Framework 4" instead of ".NET Framework 4 Client Profile" as your 'Target framework'.
*
* Next, visit Project | Add reference, and select "System.Web" (specifically
* System.Web - not System.Web.&lt;something&gt;).
*/</span>

<span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Web</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">SMS</span> <span class="p">{</span>
  <span class="k">public</span> <span class="k">class</span> <span class="nc">SendSMS</span> <span class="p">{</span>

    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span> <span class="p">)</span> <span class="p">{</span>
      <span class="cm">/*
      * Simply substitute your own username, password and phone number
      * below, and run the test code:
      */</span>
      <span class="kt">string</span> <span class="n">username</span> <span class="p">=</span> <span class="s">"username"</span><span class="p">;</span>
      <span class="kt">string</span> <span class="n">password</span> <span class="p">=</span> <span class="s">"password"</span><span class="p">;</span>
      <span class="cm">/*
      * Your phone number, including country code, i.e. +44123123123 in this case:
      */</span>
      <span class="kt">string</span> <span class="n">msisdn</span>   <span class="p">=</span> <span class="s">"447123123123"</span><span class="p">;</span>

      <span class="kt">string</span> <span class="n">url</span> <span class="p">=</span> <span class="s">"«EAPI URL»/submission/send_sms/2/2.0"</span><span class="p">;</span>

      <span class="cm">/*
      * A 7-bit GSM SMS message can contain up to 160 characters (longer messages can be
      * achieved using concatenation).
      *
      * All non-alphanumeric 7-bit GSM characters are included in this example. Note that Greek characters,
      * and extended GSM characters (e.g. the caret "^"), may not be supported
      * to all networks. Please let us know if you require support for any characters that
      * do not appear to work to your network.
      */</span>
      <span class="kt">string</span> <span class="n">seven_bit_msg</span> <span class="p">=</span> <span class="s">"Test message: all non-alphanumeric GSM characters: $@!#%&amp;\",;:&lt;&gt;¡£¤¥§¿ÄÅÆÇÉÑÖØÜßàèéùìòå¿äöñüà\nGreek: ΩΘΔΦΓΛΩΠΨΣΘΞ"</span><span class="p">;</span>


      <span class="cm">/*
      * A Unicode SMS can contain only 70 characters. Any Unicode character can be sent,
      * including those GSM and accented ISO-8859 European characters that are not
      * catered for by the GSM character set, but note that mobile phones are only able
      * to display certain Unicode characters, based on their geographic market.
      * Nonetheless, every mobile phone should be able to display at least the text
      * "Unicode test message:" from the test message below. Your browser may be able to
      * display more of the characters than your phone. The text of the message below is:
      */</span>
      <span class="kt">string</span> <span class="n">unicode_msg</span> <span class="p">=</span> <span class="s">"Unicode test message: ☺ \nArabic: شصض\nChinese: 本网"</span><span class="p">;</span>

      <span class="cm">/*
      * There's a number of 8 bit messages that one can send to a handset, the most popular of the lot is Service Indication(Wap Push).
      * Some other popular ones are vCards and vCalendars, headers may vary depending on which of message one opts to send.
      * The User Data Header(UDH) is solely responsible for determining which
      * type of messages will be sent to ones' handset.
      * In a nutshell, SI(service indication) messages will have, in the final message body, both the UDH
      * and WSP(Wireless Session Protocol) appended to each other forming a prefix of the ASCII string of the Hex value
      * of the actual content. For example, suppose our intended Wap message body is as follows:
      *
      * &lt;si&gt;&lt;indication href="http://www.bulksms.com"&gt;Visit BulkSMS.com homepage&lt;/indication&gt;&lt;/si&gt;
      *
      * Our headers will be -- UDH + WSP = FINAL_HEADER
      * '0605040B8423F0' + 'DC0601AE' = '0605040B8423F0DC0601AE'
      *
      * The UDH contains a destination port(0B84) and the origin port(23F0)
      * the WSP is broken down into the following:
      *
      * DC - Transaction ID (used to associate PDUs)
      * 06 - PDU type (push PDU)
      * 01 - HeadersLen (total of content-type and headers, i.e. zero headers)
      * AE - Content Type: application/vnd.wap.sic
      *
      * For this example our 8 bit message(what becomes our Wap Push) will look like this:
      * $msg = '0605040B8423F0DC0601AE02056a0045c60d0362756c6b736d732e636f6d00010356697369742042756c6b534d532e636f6d20686f6d6570616765000101';
      *
      * You will only get UDH for both vCard and vCalendar type of 8 bit messages and no WSP, which will look something to this effect:
      * '06050423F4000'
      *
      * Now moving on and considering the example above, we will need to determine the type of message and get the header(s)
      * there of.
      *
      * string msg_type = "wap_push";
      * string msg_body = "&lt;si&gt;&lt;indication href=\"http://www.bulksms.com\"&gt;Visit BulkSMS.com homepage&lt;/indication&gt;&lt;/si&gt;";
      * string eight_bit_msg = get_headers( msg_type ) + xml_to_wbxml( msg_body );
      */</span>
      <span class="kt">string</span> <span class="n">eight_bit_msg</span> <span class="p">=</span> <span class="s">"0605040B8423F0DC0601AE02056a0045c60d0362756c6b736d732e636f6d00010356697369742042756c6b534d532e636f6d20686f6d6570616765000101"</span><span class="p">;</span>

      <span class="n">Hashtable</span> <span class="n">result</span><span class="p">;</span>

      <span class="cm">/*
      * Upon a transient (retryable) error, sleep this many seconds:
      */</span>
      <span class="kt">int</span> <span class="n">sleep_time</span> <span class="p">=</span> <span class="m">3</span><span class="p">;</span>
      <span class="cm">/*
      * The time it takes to retry transient errors will increase with
      * each retry attempt:
      */</span>
      <span class="kt">int</span> <span class="n">retry_growth_factor</span> <span class="p">=</span> <span class="m">8</span><span class="p">;</span>
      <span class="kt">int</span> <span class="n">num_retries</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>

      <span class="kt">string</span> <span class="n">data</span> <span class="p">=</span> <span class="nf">seven_bit_message</span><span class="p">(</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">msisdn</span><span class="p">,</span> <span class="n">seven_bit_msg</span> <span class="p">);</span>

      <span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">x</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">x</span> <span class="p">&lt;</span> <span class="n">num_retries</span><span class="p">;</span> <span class="n">x</span><span class="p">++</span> <span class="p">)</span> <span class="p">{</span>
        <span class="n">result</span> <span class="p">=</span> <span class="nf">send_sms</span><span class="p">(</span> <span class="n">data</span><span class="p">,</span> <span class="n">url</span> <span class="p">);</span>
        <span class="k">if</span> <span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">result</span><span class="p">[</span><span class="s">"success"</span><span class="p">]</span> <span class="p">==</span> <span class="m">1</span> <span class="p">)</span> <span class="p">{</span>
          <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span> <span class="nf">formatted_server_response</span><span class="p">(</span> <span class="n">result</span> <span class="p">)</span> <span class="p">);</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span> <span class="nf">formatted_server_response</span><span class="p">(</span> <span class="n">result</span> <span class="p">)</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="n">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">);</span>
        <span class="n">sleep_time</span> <span class="p">*=</span> <span class="n">retry_growth_factor</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="n">sleep_time</span> <span class="p">=</span> <span class="m">3</span><span class="p">;</span>
      <span class="n">data</span> <span class="p">=</span> <span class="nf">eight_bit_message</span><span class="p">(</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">msisdn</span><span class="p">,</span> <span class="n">eight_bit_msg</span> <span class="p">);</span>
      <span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">x</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">x</span> <span class="p">&lt;</span> <span class="n">num_retries</span><span class="p">;</span> <span class="n">x</span><span class="p">++</span> <span class="p">)</span> <span class="p">{</span>
        <span class="n">result</span> <span class="p">=</span> <span class="nf">send_sms</span><span class="p">(</span> <span class="n">data</span><span class="p">,</span> <span class="n">url</span> <span class="p">);</span>
        <span class="k">if</span> <span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">result</span><span class="p">[</span><span class="s">"success"</span><span class="p">]</span> <span class="p">==</span> <span class="m">1</span> <span class="p">)</span> <span class="p">{</span>
          <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span> <span class="nf">formatted_server_response</span><span class="p">(</span> <span class="n">result</span> <span class="p">)</span> <span class="p">);</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span> <span class="nf">formatted_server_response</span><span class="p">(</span> <span class="n">result</span> <span class="p">)</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="n">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">);</span>
        <span class="n">sleep_time</span> <span class="p">*=</span> <span class="n">retry_growth_factor</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="n">sleep_time</span> <span class="p">=</span> <span class="m">3</span><span class="p">;</span>
      <span class="n">data</span> <span class="p">=</span> <span class="nf">unicode_message</span><span class="p">(</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">msisdn</span><span class="p">,</span> <span class="n">unicode_msg</span> <span class="p">);</span>
      <span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">x</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">x</span> <span class="p">&lt;</span> <span class="n">num_retries</span><span class="p">;</span> <span class="n">x</span><span class="p">++</span> <span class="p">)</span> <span class="p">{</span>
        <span class="n">result</span> <span class="p">=</span> <span class="nf">send_sms</span><span class="p">(</span> <span class="n">data</span><span class="p">,</span> <span class="n">url</span> <span class="p">);</span>
        <span class="k">if</span> <span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">result</span><span class="p">[</span><span class="s">"success"</span><span class="p">]</span> <span class="p">==</span> <span class="m">1</span> <span class="p">)</span> <span class="p">{</span>
          <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span> <span class="nf">formatted_server_response</span><span class="p">(</span> <span class="n">result</span> <span class="p">)</span> <span class="p">);</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span> <span class="nf">formatted_server_response</span><span class="p">(</span> <span class="n">result</span> <span class="p">)</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="n">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">);</span>
        <span class="n">sleep_time</span> <span class="p">*=</span> <span class="n">retry_growth_factor</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">formatted_server_response</span><span class="p">(</span> <span class="n">Hashtable</span> <span class="n">result</span> <span class="p">)</span> <span class="p">{</span>
      <span class="kt">string</span> <span class="n">ret_string</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
      <span class="k">if</span><span class="p">(</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">result</span><span class="p">[</span><span class="s">"success"</span><span class="p">]</span> <span class="p">==</span> <span class="m">1</span> <span class="p">)</span> <span class="p">{</span>
        <span class="n">ret_string</span> <span class="p">+=</span> <span class="s">"Success: batch ID "</span> <span class="p">+</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">result</span><span class="p">[</span><span class="s">"api_batch_id"</span><span class="p">]</span> <span class="p">+</span> <span class="s">"API message: "</span> <span class="p">+</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">result</span><span class="p">[</span><span class="s">"api_message"</span><span class="p">]</span> <span class="p">+</span> <span class="s">"\nFull details "</span> <span class="p">+</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">result</span><span class="p">[</span><span class="s">"details"</span><span class="p">];</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="n">ret_string</span> <span class="p">+=</span> <span class="s">"Fatal error: HTTP status "</span> <span class="p">+</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">result</span><span class="p">[</span><span class="s">"http_status_code"</span><span class="p">]</span> <span class="p">+</span> <span class="s">" API status "</span> <span class="p">+</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">result</span><span class="p">[</span><span class="s">"api_status_code"</span><span class="p">]</span> <span class="p">+</span> <span class="s">" API message "</span> <span class="p">+</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">result</span><span class="p">[</span><span class="s">"api_message"</span><span class="p">]</span> <span class="p">+</span> <span class="s">"\nFull details "</span> <span class="p">+</span> <span class="p">(</span><span class="kt">string</span><span class="p">)</span><span class="n">result</span><span class="p">[</span><span class="s">"details"</span><span class="p">];</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="n">ret_string</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">Hashtable</span> <span class="nf">send_sms</span><span class="p">(</span> <span class="kt">string</span> <span class="n">data</span><span class="p">,</span> <span class="kt">string</span> <span class="n">url</span> <span class="p">)</span> <span class="p">{</span>
      <span class="kt">string</span> <span class="n">sms_result</span> <span class="p">=</span> <span class="nf">Post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>

      <span class="n">Hashtable</span> <span class="n">result_hash</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Hashtable</span><span class="p">();</span>

      <span class="kt">string</span> <span class="n">tmp</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
      <span class="n">tmp</span> <span class="p">+=</span> <span class="s">"Response from server: "</span> <span class="p">+</span> <span class="n">sms_result</span> <span class="p">+</span> <span class="s">"\n"</span><span class="p">;</span>
      <span class="kt">string</span><span class="p">[]</span> <span class="n">parts</span> <span class="p">=</span> <span class="n">sms_result</span><span class="p">.</span><span class="nf">Split</span><span class="p">(</span><span class="sc">'|'</span><span class="p">);</span>

      <span class="kt">string</span> <span class="n">statusCode</span> <span class="p">=</span> <span class="n">parts</span><span class="p">[</span><span class="m">0</span><span class="p">];</span>
      <span class="kt">string</span> <span class="n">statusString</span> <span class="p">=</span> <span class="n">parts</span><span class="p">[</span><span class="m">1</span><span class="p">];</span>

      <span class="n">result_hash</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api_status_code"</span><span class="p">,</span> <span class="n">statusCode</span><span class="p">);</span>
      <span class="n">result_hash</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api_message"</span><span class="p">,</span> <span class="n">statusString</span><span class="p">);</span>

      <span class="k">if</span><span class="p">(</span><span class="n">parts</span><span class="p">.</span><span class="n">Length</span> <span class="p">!=</span> <span class="m">3</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">tmp</span> <span class="p">+=</span> <span class="s">"Error: could not parse valid return data from server.\n"</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">statusCode</span><span class="p">.</span><span class="nf">Equals</span><span class="p">(</span><span class="s">"0"</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
          <span class="n">result_hash</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"success"</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
          <span class="n">result_hash</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api_batch_id"</span><span class="p">,</span> <span class="n">parts</span><span class="p">[</span><span class="m">2</span><span class="p">]);</span>
          <span class="n">tmp</span> <span class="p">+=</span> <span class="s">"Message sent - batch ID "</span> <span class="p">+</span> <span class="n">parts</span><span class="p">[</span><span class="m">2</span><span class="p">]</span> <span class="p">+</span> <span class="s">"\n"</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">statusCode</span><span class="p">.</span><span class="nf">Equals</span><span class="p">(</span><span class="s">"1"</span><span class="p">))</span> <span class="p">{</span>
          <span class="c1">// Success: scheduled for later sending.</span>
          <span class="n">result_hash</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"success"</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
          <span class="n">result_hash</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api_batch_id"</span><span class="p">,</span> <span class="n">parts</span><span class="p">[</span><span class="m">2</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="n">result_hash</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"success"</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
          <span class="n">tmp</span> <span class="p">+=</span> <span class="s">"Error sending: status code "</span> <span class="p">+</span> <span class="n">parts</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">+</span> <span class="s">" description: "</span> <span class="p">+</span> <span class="n">parts</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="p">+</span> <span class="s">"\n"</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="n">result_hash</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"details"</span><span class="p">,</span> <span class="n">tmp</span><span class="p">);</span>
      <span class="k">return</span> <span class="n">result_hash</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">Post</span><span class="p">(</span><span class="kt">string</span> <span class="n">url</span><span class="p">,</span> <span class="kt">string</span> <span class="n">data</span><span class="p">)</span> <span class="p">{</span>

      <span class="kt">string</span> <span class="n">result</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="kt">byte</span><span class="p">[]</span> <span class="n">buffer</span> <span class="p">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

        <span class="n">HttpWebRequest</span> <span class="n">WebReq</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebRequest</span><span class="p">)</span><span class="n">WebRequest</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
        <span class="n">WebReq</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="s">"POST"</span><span class="p">;</span>
        <span class="n">WebReq</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">"application/x-www-form-urlencoded"</span><span class="p">;</span>
        <span class="n">WebReq</span><span class="p">.</span><span class="n">ContentLength</span> <span class="p">=</span> <span class="n">buffer</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span>
        <span class="n">Stream</span> <span class="n">PostData</span> <span class="p">=</span> <span class="n">WebReq</span><span class="p">.</span><span class="nf">GetRequestStream</span><span class="p">();</span>

        <span class="n">PostData</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">buffer</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
        <span class="n">PostData</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
        <span class="n">HttpWebResponse</span> <span class="n">WebResp</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebResponse</span><span class="p">)</span><span class="n">WebReq</span><span class="p">.</span><span class="nf">GetResponse</span><span class="p">();</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">WebResp</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">);</span>

        <span class="n">Stream</span> <span class="n">Response</span> <span class="p">=</span> <span class="n">WebResp</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">();</span>
        <span class="n">StreamReader</span> <span class="n">_Response</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">Response</span><span class="p">);</span>
        <span class="n">result</span> <span class="p">=</span>  <span class="n">_Response</span><span class="p">.</span><span class="nf">ReadToEnd</span><span class="p">();</span>
      <span class="p">}</span>
      <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">ex</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="n">result</span><span class="p">.</span><span class="nf">Trim</span><span class="p">()+</span><span class="s">"\n"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">character_resolve</span><span class="p">(</span><span class="kt">string</span> <span class="n">body</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">Hashtable</span> <span class="n">chrs</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Hashtable</span><span class="p">();</span>
      <span class="n">chrs</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="sc">'Ω'</span><span class="p">,</span> <span class="s">"Û"</span><span class="p">);</span>
      <span class="n">chrs</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="sc">'Θ'</span><span class="p">,</span> <span class="s">"Ô"</span><span class="p">);</span>
      <span class="n">chrs</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="sc">'Δ'</span><span class="p">,</span> <span class="s">"Ð"</span><span class="p">);</span>
      <span class="n">chrs</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="sc">'Φ'</span><span class="p">,</span> <span class="s">"Þ"</span><span class="p">);</span>
      <span class="n">chrs</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="sc">'Γ'</span><span class="p">,</span> <span class="s">"¬"</span><span class="p">);</span>
      <span class="n">chrs</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="sc">'Λ'</span><span class="p">,</span> <span class="s">"Â"</span><span class="p">);</span>
      <span class="n">chrs</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="sc">'Π'</span><span class="p">,</span> <span class="s">"º"</span><span class="p">);</span>
      <span class="n">chrs</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="sc">'Ψ'</span><span class="p">,</span> <span class="s">"Ý"</span><span class="p">);</span>
      <span class="n">chrs</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="sc">'Σ'</span><span class="p">,</span> <span class="s">"Ê"</span><span class="p">);</span>
      <span class="n">chrs</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="sc">'Ξ'</span><span class="p">,</span> <span class="s">"±"</span><span class="p">);</span>

      <span class="kt">string</span> <span class="n">ret_str</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
      <span class="k">foreach</span> <span class="p">(</span> <span class="kt">char</span> <span class="n">c</span> <span class="k">in</span> <span class="n">body</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">chrs</span><span class="p">.</span><span class="nf">ContainsKey</span><span class="p">(</span> <span class="n">c</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
          <span class="n">ret_str</span> <span class="p">+=</span> <span class="n">chrs</span><span class="p">[</span> <span class="n">c</span> <span class="p">];</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
          <span class="n">ret_str</span> <span class="p">+=</span> <span class="n">c</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="n">ret_str</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">seven_bit_message</span><span class="p">(</span> <span class="kt">string</span> <span class="n">username</span><span class="p">,</span> <span class="kt">string</span> <span class="n">password</span><span class="p">,</span> <span class="kt">string</span> <span class="n">msisdn</span><span class="p">,</span> <span class="kt">string</span> <span class="n">message</span> <span class="p">)</span> <span class="p">{</span>

      <span class="cm">/********************************************************************
      * Construct data                                                    *
      *********************************************************************/</span>
      <span class="cm">/*
      * Note the suggested encoding for the some parameters, notably
      * the username, password and especially the message.  ISO-8859-1
      * is essentially the character set that we use for message bodies,
      * with a few exceptions for e.g. Greek characters. For a full list,
      * see: https://www.bulksms.com/developer/eapi/submission/character-encoding/
      */</span>

      <span class="kt">string</span> <span class="n">data</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
      <span class="n">data</span> <span class="p">+=</span> <span class="s">"username="</span>  <span class="p">+</span> <span class="n">HttpUtility</span><span class="p">.</span><span class="nf">UrlEncode</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="nf">GetEncoding</span><span class="p">(</span><span class="s">"ISO-8859-1"</span><span class="p">));</span>
      <span class="n">data</span> <span class="p">+=</span> <span class="s">"&amp;password="</span> <span class="p">+</span> <span class="n">HttpUtility</span><span class="p">.</span><span class="nf">UrlEncode</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="nf">GetEncoding</span><span class="p">(</span><span class="s">"ISO-8859-1"</span><span class="p">));</span>
      <span class="n">data</span> <span class="p">+=</span> <span class="s">"&amp;message="</span>  <span class="p">+</span> <span class="n">HttpUtility</span><span class="p">.</span><span class="nf">UrlEncode</span><span class="p">(</span><span class="nf">character_resolve</span><span class="p">(</span><span class="n">message</span><span class="p">),</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="nf">GetEncoding</span><span class="p">(</span><span class="s">"ISO-8859-1"</span><span class="p">));</span>
      <span class="n">data</span> <span class="p">+=</span> <span class="s">"&amp;msisdn="</span> <span class="p">+</span> <span class="n">msisdn</span><span class="p">;</span>
      <span class="n">data</span> <span class="p">+=</span> <span class="s">"&amp;want_report=1"</span><span class="p">;</span>

      <span class="k">return</span> <span class="n">data</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">unicode_message</span><span class="p">(</span> <span class="kt">string</span> <span class="n">username</span><span class="p">,</span> <span class="kt">string</span> <span class="n">password</span><span class="p">,</span> <span class="kt">string</span> <span class="n">msisdn</span><span class="p">,</span> <span class="kt">string</span> <span class="n">message</span> <span class="p">)</span> <span class="p">{</span>

      <span class="cm">/********************************************************************
      * Construct data                                                    *
      *********************************************************************/</span>
      <span class="cm">/*
      * Note the suggested encoding for the some parameters, notably
      * the username, password and especially the message.  ISO-8859-1
      * is essentially the character set that we use for message bodies,
      * with a few exceptions for e.g. Greek characters. For a full list,
      * see: https://www.bulksms.com/developer/eapi/submission/character-encoding/
      */</span>


      <span class="kt">string</span> <span class="n">data</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
      <span class="n">data</span> <span class="p">+=</span> <span class="s">"username="</span>  <span class="p">+</span> <span class="n">HttpUtility</span><span class="p">.</span><span class="nf">UrlEncode</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="nf">GetEncoding</span><span class="p">(</span><span class="s">"ISO-8859-1"</span><span class="p">));</span>
      <span class="n">data</span> <span class="p">+=</span> <span class="s">"&amp;password="</span> <span class="p">+</span> <span class="n">HttpUtility</span><span class="p">.</span><span class="nf">UrlEncode</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="nf">GetEncoding</span><span class="p">(</span><span class="s">"ISO-8859-1"</span><span class="p">));</span>
      <span class="n">data</span> <span class="p">+=</span> <span class="s">"&amp;message="</span>  <span class="p">+</span> <span class="nf">stringToHex</span><span class="p">(</span> <span class="n">message</span> <span class="p">);</span>
      <span class="n">data</span> <span class="p">+=</span> <span class="s">"&amp;msisdn="</span> <span class="p">+</span> <span class="n">msisdn</span><span class="p">;</span>
      <span class="n">data</span> <span class="p">+=</span> <span class="s">"&amp;dca=16bit"</span><span class="p">;</span>
      <span class="n">data</span> <span class="p">+=</span> <span class="s">"&amp;want_report=1"</span><span class="p">;</span>

      <span class="k">return</span> <span class="n">data</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">eight_bit_message</span><span class="p">(</span> <span class="kt">string</span> <span class="n">username</span><span class="p">,</span> <span class="kt">string</span> <span class="n">password</span><span class="p">,</span> <span class="kt">string</span> <span class="n">msisdn</span><span class="p">,</span> <span class="kt">string</span> <span class="n">message</span> <span class="p">)</span> <span class="p">{</span>

      <span class="cm">/********************************************************************
      * Construct data                                                    *
      *********************************************************************/</span>
      <span class="cm">/*
      * Note the suggested encoding for the some parameters, notably
      * the username, password and especially the message.  ISO-8859-1
      * is essentially the character set that we use for message bodies,
      * with a few exceptions for e.g. Greek characters. For a full list,
      * see: https://www.bulksms.com/developer/eapi/submission/character-encoding/
      */</span>

      <span class="cm">/*
      * In the following $udh string, 0B84 is a destination port and 23F0 is the origin port.
      */</span>
      <span class="kt">string</span> <span class="n">udh</span> <span class="p">=</span> <span class="s">"0605040B8423F0"</span><span class="p">;</span>

      <span class="cm">/*
      * $wsp_header is broken down into the following:
      *
      * DC - Transaction ID (used to associate PDUs)
      * 06 - PDU type (push PDU)
      * 01 - HeadersLen (total of content-type and headers, i.e. zero headers)
      * AE - Content Type: application/vnd.wap.sic
      */</span>
      <span class="kt">string</span> <span class="n">wsp_header</span> <span class="p">=</span> <span class="s">"DC0601AE"</span><span class="p">;</span>
      <span class="kt">string</span> <span class="n">wap_push_message</span> <span class="p">=</span> <span class="n">udh</span> <span class="p">+</span> <span class="n">wsp_header</span> <span class="p">+</span> <span class="n">message</span><span class="p">;</span>

      <span class="kt">string</span> <span class="n">data</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
      <span class="n">data</span> <span class="p">+=</span> <span class="s">"username="</span>  <span class="p">+</span> <span class="n">HttpUtility</span><span class="p">.</span><span class="nf">UrlEncode</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="nf">GetEncoding</span><span class="p">(</span><span class="s">"ISO-8859-1"</span><span class="p">));</span>
      <span class="n">data</span> <span class="p">+=</span> <span class="s">"&amp;password="</span> <span class="p">+</span> <span class="n">HttpUtility</span><span class="p">.</span><span class="nf">UrlEncode</span><span class="p">(</span><span class="n">password</span><span class="p">,</span>  <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="nf">GetEncoding</span><span class="p">(</span><span class="s">"ISO-8859-1"</span><span class="p">));</span>
      <span class="n">data</span> <span class="p">+=</span> <span class="s">"&amp;message="</span>  <span class="p">+</span> <span class="n">wap_push_message</span><span class="p">;</span>
      <span class="n">data</span> <span class="p">+=</span> <span class="s">"&amp;msisdn="</span>   <span class="p">+</span> <span class="n">msisdn</span><span class="p">;</span>
      <span class="n">data</span> <span class="p">+=</span> <span class="s">"&amp;dca=8bit"</span><span class="p">;</span>
      <span class="n">data</span> <span class="p">+=</span> <span class="s">"&amp;want_report=1"</span><span class="p">;</span>

      <span class="k">return</span> <span class="n">data</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">get_headers</span><span class="p">(</span> <span class="kt">string</span> <span class="n">msg_type</span> <span class="p">)</span> <span class="p">{</span>
      <span class="kt">string</span> <span class="n">headers</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
      <span class="k">if</span><span class="p">(</span> <span class="n">msg_type</span> <span class="p">==</span> <span class="s">"wap_push"</span> <span class="p">)</span> <span class="p">{</span>
        <span class="kt">string</span> <span class="n">udh</span> <span class="p">=</span> <span class="s">"0605040B8423F0"</span><span class="p">;</span>
        <span class="kt">string</span> <span class="n">wsp</span> <span class="p">=</span> <span class="s">"DC0601AE"</span><span class="p">;</span>

        <span class="n">headers</span> <span class="p">+=</span> <span class="n">udh</span> <span class="p">+</span> <span class="n">wsp</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="k">if</span><span class="p">(</span> <span class="n">msg_type</span> <span class="p">==</span> <span class="s">"vCard"</span> <span class="p">||</span> <span class="n">msg_type</span> <span class="p">==</span> <span class="s">"vCalendar"</span> <span class="p">)</span> <span class="p">{</span>
        <span class="n">headers</span> <span class="p">+=</span> <span class="s">"06050423F40000"</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="n">headers</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">xml_to_string</span><span class="p">(</span> <span class="kt">string</span> <span class="n">msg_body</span> <span class="p">)</span> <span class="p">{</span>
      <span class="c1">//TODO</span>
      <span class="cm">/*
      * Code to convert 'msg_body' will go in here.
      */</span>

      <span class="k">return</span> <span class="s">"conversion"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">stringToHex</span><span class="p">(</span><span class="kt">string</span> <span class="n">s</span><span class="p">){</span>
      <span class="kt">string</span> <span class="n">hex</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
      <span class="k">foreach</span> <span class="p">(</span><span class="kt">char</span> <span class="n">c</span> <span class="k">in</span> <span class="n">s</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="kt">int</span> <span class="n">tmp</span> <span class="p">=</span> <span class="n">c</span><span class="p">;</span>
        <span class="n">hex</span> <span class="p">+=</span> <span class="n">String</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"{0:x4}"</span><span class="p">,</span> <span class="p">(</span><span class="kt">uint</span><span class="p">)</span><span class="n">System</span><span class="p">.</span><span class="n">Convert</span><span class="p">.</span><span class="nf">ToUInt32</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="nf">ToString</span><span class="p">()));</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="n">hex</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

    </div>
    <div class="col-md-2">
        <div class="btn-group-vertical">
            <a class="btn btn-default" href="../../../index.html">Quick Start</a>
            <a class="btn btn-default" href="../../../overview.html">Overview</a>
            <a class="btn btn-default" href="../../../submission/index.html">Submission</a>
            <a class="btn btn-default" href="../../../reception/index.html">Reception</a>
            <a class="btn btn-default" href="../../../status_reports/index.html">Status Reports</a>
            <a class="btn btn-default" href="../../../phonebook/index.html">Phonebook</a>

            <a class="btn btn-default" href="../../../account/index.html">Account</a>
        </div>
    </div>
  </div>
</div>


    </div>

    <script src="../../../../js/jquery-1.11.0.min.js"></script>
    <script src="../../../../js/bootstrap-3.1.1.min.js"></script>
    <script src="../../../../js/highlight-8.4.min.js"></script>
    <script src="../../../../js/fardt-0.4.2.min.js"></script>

    <script >
    $(function () {
        $('[data-toggle="tooltip"]').tooltip();
        $('[data-toggle="popover"]').popover();
    })
    </script>

    <script src="../../../../js/scripts.js"></script>
    
    <!-- Google Analytics -->
    <script>
    var gacode = (("www.bulksms.com" == document.location.hostname) ? "UA-540842-13" : "UA-540842-12");

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','../../../../../../www.google-analytics.com/analytics.js','ga');
    ga('create', gacode, 'auto');
    ga('send', 'pageview');
    </script>
    <!-- End Google Analytics -->

</body>

<!-- Mirrored from www.bulksms.com/developer/eapi/code-samples/csharp/send_sms/ by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 15 Oct 2019 07:43:31 GMT -->
</html>
